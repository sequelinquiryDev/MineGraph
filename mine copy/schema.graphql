#############################
# UNISWAP V3 ENTITIES
#############################

type FeeAmountEnabled @entity(immutable: true) {
  id: Bytes!
  fee: Int!          # uint24
  tickSpacing: Int!  # int24
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type OwnerChanged @entity(immutable: true) {
  id: Bytes!
  oldOwner: Bytes!   # address
  newOwner: Bytes!   # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type PoolCreated @entity(immutable: true) {
  id: Bytes!
  token0: Bytes!     # address
  token1: Bytes!     # address
  fee: Int!          # uint24
  tickSpacing: Int!  # int24
  pool: Bytes!       # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

#############################
# UNISWAP V2 / SUSHISWAP V2 ENTITIES
#############################

type PairCreated @entity(immutable: true) {
  id: Bytes!
  token0: Bytes!     # address
  token1: Bytes!     # address
  pair: Bytes!       # address
  param3: BigInt!    # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

#############################
# POOL LIVE STATE ENTITY
# Tracks real-time fields for topology + swap calculations
#############################

type Pool @entity {
  id: Bytes!                  # pool address (primary key)

  #### Tokens
  token0: Bytes!              # token0 address
  token1: Bytes!              # token1 address

  #### V3 specific
  feeTier: Int                # only for V3 pools
  tickSpacing: Int            # only for V3 pools

  #### Live fields
  reserve0: BigDecimal        # current reserve of token0
  reserve1: BigDecimal        # current reserve of token1
  reserveUSD: BigDecimal      # total USD value of reserves
  volumeUSD: BigDecimal       # cumulative volume in USD
  txCount: BigInt             # cumulative number of swaps
  totalValueLockedUSD: BigDecimal # cumulative liquidity USD value

  #### Metadata
  dexType: String             # "v2" or "v3"
  createdAtBlock: BigInt
  createdAtTimestamp: BigInt
}