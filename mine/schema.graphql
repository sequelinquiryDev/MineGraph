#############################
# POOL LIVE STATE ENTITY
# Combines V2 and V3 pools
#############################

type Pool @entity(immutable: false) {
  id: Bytes!                  # pool address (primary key)

  #### Tokens
  token0: Bytes!              # token0 address
  token1: Bytes!              # token1 address

  #### V3 specific
  feeTier: Int                # only for V3 pools
  tickSpacing: Int            # only for V3 pools

  #### Live fields
  reserve0: BigDecimal        # current reserve of token0
  reserve1: BigDecimal        # current reserve of token1
  txCount: BigInt             # cumulative number of swaps

  #### Metadata
  dexType: String             # "v2" or "v3"
  createdAtBlock: BigInt
  createdAtTimestamp: BigInt
}

#############################
# FACTORY EVENTS
# Only needed to create templates for Pool
#############################

type PoolCreated @entity(immutable: true) {
  id: Bytes!
  token0: Bytes!
  token1: Bytes!
  fee: Int!          # uint24
  tickSpacing: Int!  # int24
  pool: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type PairCreated @entity(immutable: true) {
  id: Bytes!
  token0: Bytes!
  token1: Bytes!
  pair: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}